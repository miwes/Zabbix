<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>5.0</version>
    <date>2021-11-15T07:23:57Z</date>
    <groups>
        <group>
            <name>My Templates</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>Template AC Active Directory</template>
            <name>Template AC Active Directory</name>
            <description>AC &#13;
Version : 1.0&#13;
Last update 13.5.2021&#13;
&#13;
From source https://aanikonov.blogspot.com/2018/10/ad-ds-health-and-perfomance.html</description>
            <groups>
                <group>
                    <name>My Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>AD DNS</name>
                </application>
                <application>
                    <name>AD Events</name>
                </application>
                <application>
                    <name>AD Network ports</name>
                </application>
                <application>
                    <name>AD Performance</name>
                </application>
                <application>
                    <name>AD Services</name>
                </application>
                <application>
                    <name>AD Storage</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Active Directory Web Services Events</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[Active Directory Web Services,,&quot;Warning|Error&quot;]</key>
                    <delay>5m</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <applications>
                        <application>
                            <name>AD Events</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{logseverity(0)}&gt;1 and {nodata(1800)}=0</expression>
                            <name>Active Directory Web Services Error on {HOST.NAME}</name>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>DFS Replication Events</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[DFS Replication,,&quot;Error&quot;]</key>
                    <delay>5m</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <applications>
                        <application>
                            <name>AD Events</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{logseverity(0)}&gt;1 and {nodata(1800)}=0</expression>
                            <name>DFS Replication Events Error on {HOST.NAME}</name>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Directory Service Events</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[Directory Service,,&quot;Warning|Error&quot;,,*(3041|2887)]</key>
                    <delay>5m</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <applications>
                        <application>
                            <name>AD Events</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{logseverity(0)}&gt;1 and {nodata(1800)}=0</expression>
                            <name>Directory Service Events Error on {HOST.NAME}</name>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>DNS Server Events</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[DNS Server,,&quot;Warning|Error&quot;]</key>
                    <delay>5m</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <applications>
                        <application>
                            <name>AD Events</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{logseverity(0)}&gt;1 and {nodata(1800)}=0</expression>
                            <name>DNS Server Events Error on {HOST.NAME}</name>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>DNS resolve domain {$DOMAINNAME}</name>
                    <key>net.dns[,{$DOMAINNAME},A,2,1]</key>
                    <applications>
                        <application>
                            <name>AD DNS</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{max(#3)}=0</expression>
                            <name>DNS not resolving {$DOMAINNAME}</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>DNS Port is running</name>
                    <key>net.tcp.listen[53]</key>
                    <history>1w</history>
                    <applications>
                        <application>
                            <name>AD Network ports</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Service state</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{max(#3)}=0</expression>
                            <name>DNS port down on {HOST.NAME}</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Kerberos Port is running</name>
                    <key>net.tcp.listen[88]</key>
                    <history>1w</history>
                    <applications>
                        <application>
                            <name>AD Network ports</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Service state</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{max(#3)}=0</expression>
                            <name>Kerberos port down on {HOST.NAME}</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>SMB Port is running</name>
                    <key>net.tcp.listen[445]</key>
                    <history>1w</history>
                    <applications>
                        <application>
                            <name>AD Network ports</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Service state</name>
                    </valuemap>
                </item>
                <item>
                    <name>LDAPs is running</name>
                    <key>net.tcp.listen[636]</key>
                    <history>1w</history>
                    <applications>
                        <application>
                            <name>AD Network ports</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Service state</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{max(#3)}=0</expression>
                            <name>LDAPs port down on {HOST.NAME}</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>LDAP GC Port is running</name>
                    <key>net.tcp.listen[3268]</key>
                    <history>1w</history>
                    <applications>
                        <application>
                            <name>AD Network ports</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Service state</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{max(#3)}=0</expression>
                            <name>LDAP GC port down on {HOST.NAME}</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>LDAP GC SSL Port is running</name>
                    <key>net.tcp.listen[3269]</key>
                    <history>1w</history>
                    <applications>
                        <application>
                            <name>AD Network ports</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Service state</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{max(#3)}=0</expression>
                            <name>LDAP GC SSL port down on {HOST.NAME}</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>LDAP Port is running</name>
                    <type>SIMPLE</type>
                    <key>net.tcp.service[ldap]</key>
                    <history>1w</history>
                    <applications>
                        <application>
                            <name>AD Network ports</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Service state</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{max(#3)}=0</expression>
                            <name>LDAP service is down on {HOST.NAME}</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>I/O Database Reads/sec</name>
                    <key>perf_counter_en[&quot;\Database ==&gt; Instances(lsass/NTDSA)\I/O Database Reads/sec&quot;]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>/s</units>
                    <description>perf_counter[\Database ==&gt; Instances(lsass/NTDSA)\I/O Database Reads/sec]</description>
                    <applications>
                        <application>
                            <name>AD Performance</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{min(#3)}&gt;10</expression>
                            <name>I/O Database Reads/sec &gt; 10 on {HOST.NAME}</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>I/O Database Reads Average Latency</name>
                    <key>perf_counter_en[&quot;\Database ==&gt; Instances(lsass/NTDSA)\I/O Database Reads Average Latency&quot;]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>ms</units>
                    <description>perf_counter[\Database ==&gt; Instances(lsass/NTDSA)\I/O Database Reads Average Latency]</description>
                    <applications>
                        <application>
                            <name>AD Performance</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{min(#3)}&gt;15</expression>
                            <name>I/O Database Reads Average Latency &gt; 15ms on {HOST.NAME}</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>I/O Log Writes/sec</name>
                    <key>perf_counter_en[&quot;\Database ==&gt; Instances(lsass/NTDSA)\I/O Log Writes/sec&quot;]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>/s</units>
                    <description>perf_counter[\Database ==&gt; Instances(lsass/NTDSA)\I/O Log Writes/sec]</description>
                    <applications>
                        <application>
                            <name>AD Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>I/O Log Writes Average Latency</name>
                    <key>perf_counter_en[&quot;\Database ==&gt; Instances(lsass/NTDSA)\I/O Log Writes Average Latency&quot;]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>ms</units>
                    <description>perf_counter[\Database ==&gt; Instances(lsass/NTDSA)\I/O Log Writes Average Latency]</description>
                    <applications>
                        <application>
                            <name>AD Performance</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{min(#3)}&gt;10</expression>
                            <name>I/O Log Writes Average Latency &gt; 10ms on {HOST.NAME}</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>DRA Inbound Bytes Total/sec</name>
                    <key>perf_counter_en[&quot;\DirectoryServices(NTDS)\DRA Inbound Bytes Total/sec&quot;]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>/s</units>
                    <description>perf_counter[\NTDA\DRA Inbound Bytes Total/sec]</description>
                    <applications>
                        <application>
                            <name>AD Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>DRA Inbound Object Updates Remaining in Packet</name>
                    <key>perf_counter_en[&quot;\DirectoryServices(NTDS)\DRA Inbound Object Updates Remaining in Packet&quot;]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <description>perf_counter[\NTDA\DRA Inbound Object Updates Remaining in Packet]</description>
                    <applications>
                        <application>
                            <name>AD Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>DRA Outbound Bytes Total/sec</name>
                    <key>perf_counter_en[&quot;\DirectoryServices(NTDS)\DRA Outbound Bytes Total/sec&quot;]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>/s</units>
                    <description>perf_counter[\NTDA\DRA Outbound Bytes Total/sec]</description>
                    <applications>
                        <application>
                            <name>AD Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>DRA Pending Replication Synchronizations</name>
                    <key>perf_counter_en[&quot;\DirectoryServices(NTDS)\DRA Pending Replication Synchronizations&quot;]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <description>perf_counter[\NTDA\DRA Pending Replication Synchronizations]</description>
                    <applications>
                        <application>
                            <name>AD Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>LDAP Writes/sec</name>
                    <key>perf_counter_en[&quot;\DirectoryServices(NTDS)\LDAP Writes/sec&quot;]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>/s</units>
                    <applications>
                        <application>
                            <name>AD Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>LDAP Active Threads</name>
                    <key>perf_counter_en[&quot;\NTDS\LDAP Active Threads&quot;]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <description>perf_counter[\NTDS\LDAP Active Threads]</description>
                    <applications>
                        <application>
                            <name>AD Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>LDAP Client Sessions</name>
                    <key>perf_counter_en[&quot;\NTDS\LDAP Client Sessions&quot;]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <description>perf_counter[\NTDS\LDAP Client Sessions]</description>
                    <applications>
                        <application>
                            <name>AD Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>LDAP Searches/sec</name>
                    <key>perf_counter_en[&quot;\NTDS\LDAP Searches/sec&quot;]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>/s</units>
                    <description>perf_counter[\NTDS\LDAP Searches/sec]</description>
                    <applications>
                        <application>
                            <name>AD Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>LSASS Processor Time</name>
                    <key>perf_counter_en[&quot;\Process(lsass)\% Processor Time&quot;]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Metric Process % Processor Time of LSASS&#13;
perf_counter[\Process(lsass)\% Processor Time]</description>
                    <applications>
                        <application>
                            <name>AD Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Kerberos Authentications</name>
                    <key>perf_counter_en[&quot;\Security system-wide statistics\Kerberos Authentications&quot;]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>/s</units>
                    <description>perf_counter[\Security system-wide statistics\Kerberos Authentications]</description>
                    <applications>
                        <application>
                            <name>AD Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>NTLM Authentications</name>
                    <key>perf_counter_en[&quot;\Security system-wide statistics\NTLM Authentications&quot;]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>/s</units>
                    <description>perf_counter[\Security system-wide statistics\NTLM Authentications]</description>
                    <applications>
                        <application>
                            <name>AD Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>State of service &quot;DFSR&quot; (DFS Replication)</name>
                    <key>service.info[DFSR,state]</key>
                    <history>1d</history>
                    <applications>
                        <application>
                            <name>AD Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                </item>
                <item>
                    <name>State of service &quot;DNS&quot; (DNS Server)</name>
                    <key>service.info[DNS,state]</key>
                    <history>1d</history>
                    <applications>
                        <application>
                            <name>AD Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                </item>
                <item>
                    <name>State of service &quot;Dnscache&quot; (DNS Client)</name>
                    <key>service.info[Dnscache,state]</key>
                    <history>1d</history>
                    <applications>
                        <application>
                            <name>AD Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                </item>
                <item>
                    <name>State of service &quot;IsmServ&quot; (Intersite Messaging)</name>
                    <key>service.info[IsmServ,state]</key>
                    <history>1d</history>
                    <applications>
                        <application>
                            <name>AD Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                </item>
                <item>
                    <name>State of service &quot;Kdc&quot; (Kerberos Key Distribution Center)</name>
                    <key>service.info[Kdc,state]</key>
                    <history>1d</history>
                    <applications>
                        <application>
                            <name>AD Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                </item>
                <item>
                    <name>State of service &quot;LanmanServer&quot; (Server)</name>
                    <key>service.info[LanmanServer,state]</key>
                    <history>1d</history>
                    <applications>
                        <application>
                            <name>AD Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                </item>
                <item>
                    <name>State of service &quot;LanmanWorkstation&quot; (Workstation)</name>
                    <key>service.info[LanmanWorkstation,state]</key>
                    <history>1d</history>
                    <applications>
                        <application>
                            <name>AD Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                </item>
                <item>
                    <name>State of service &quot;Netlogon&quot; (Netlogon)</name>
                    <key>service.info[Netlogon,state]</key>
                    <history>1d</history>
                    <applications>
                        <application>
                            <name>AD Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                </item>
                <item>
                    <name>State of service &quot;RpcSs&quot; (Remote Procedure Call (RPC))</name>
                    <key>service.info[RpcSs,state]</key>
                    <history>1d</history>
                    <applications>
                        <application>
                            <name>AD Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                </item>
                <item>
                    <name>State of service &quot;SamSs&quot; (Security Accounts Manager)</name>
                    <key>service.info[SamSs,state]</key>
                    <history>1d</history>
                    <applications>
                        <application>
                            <name>AD Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                </item>
                <item>
                    <name>State of service &quot;W32Time&quot; (Windows Time)</name>
                    <key>service.info[W32Time,state]</key>
                    <history>1d</history>
                    <applications>
                        <application>
                            <name>AD Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                </item>
            </items>
            <macros>
                <macro>
                    <macro>{$DOMAINNAME}</macro>
                    <value>aclab.local</value>
                    <description>For DNS check resolv</description>
                </macro>
            </macros>
        </template>
    </templates>
    <value_maps>
        <value_map>
            <name>Service state</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Down</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Up</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Windows service state</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Running</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Paused</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>Start pending</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>Pause pending</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>Continue pending</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>Stop pending</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>Stopped</newvalue>
                </mapping>
                <mapping>
                    <value>7</value>
                    <newvalue>Unknown</newvalue>
                </mapping>
                <mapping>
                    <value>255</value>
                    <newvalue>No such service</newvalue>
                </mapping>
            </mappings>
        </value_map>
    </value_maps>
</zabbix_export>
